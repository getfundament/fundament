{"version":3,"sources":["popup.js"],"names":["$","window","document","Popup","element","settings","this","namespace","Name","Fm","createID","config","extend","fn","defaults","elem","$elem","$popup","next","Selectors","popup","calc","timer","active","init","Defaults","trigger","transition","direction","delay","distance","hoverable","onShow","onHide","ClassNames","$window","$body","body","prototype","self","length","detach","appendTo","create","bind","class","html","attr","text","on","toggle","add","show","hide","debounce","unbind","off","calculate","offset","top","left","width","outerWidth","height","outerHeight","position","data","positioning","css","addClass","conf","clearTimeout","setTimeout","queue","onEnd","setting","destroy","remove","args","each","apply","Array","isArray","jQuery"],"mappings":"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","file":"popup.js","sourcesContent":["/**\n * Popup plugin.\n *\n * @package Fundament\n */\n;(function($, window, document) {\n    'use strict';\n\n    var Name = 'popup';\n\n    var Defaults = {\n        trigger    : 'hover',\n        transition : 'display',\n        direction  : 'southwest',\n        delay      : 100,\n        distance   : 10,\n        hoverable  : false,\n        onShow     : function() {},\n        onHide     : function() {}\n    };\n\n    var ClassNames = {\n        popup : 'popup'\n    };\n\n    var Selectors = {\n        popup : '.popup'\n    };\n\n    // Globals\n\n    var $window = $(window),\n        $body   = $(document.body);\n\n    // Constructor\n\n    function Popup(element, settings) {\n        this.namespace = '.' + Name + '.' + Fm.createID();\n        this.config    = $.extend({}, $.fn[Name].defaults, settings);\n        this.elem      = element;\n        this.$elem     = $(element);\n        this.$popup    = this.$elem.next(Selectors.popup);\n        this.calc      = null;\n        this.timer     = null;\n        this.active    = false;\n        this.init();\n    }\n\n    // Prototype\n\n    $.extend(Popup.prototype, {\n\n        init: function() {\n            var self = this;\n\n            if ( ! self.$popup.length) {\n                self.create();\n            } else {\n                // make sure the popup is a direct child\n                // of the body for absolute positioning\n                self.$popup\n                    .detach()\n                    .appendTo($body);\n            }\n\n            self.bind();\n        },\n\n        /**\n         * Create and append a new popup element.\n         */\n        create: function() {\n            var $popup = $('<div/>', {\n                    class : ClassNames.popup,\n                    html  : $('<div/>').html( this.$elem.attr('title') ).text()\n                });\n\n            $popup.appendTo($body);\n\n            this.$elem.attr('title', null);\n\n            this.$popup = $popup;\n        },\n\n        /**\n         * Bind event handlers.\n         */\n        bind: function() {\n            var self = this,\n                namespace = self.namespace;\n\n            switch (self.config.trigger) {\n                case 'click':\n                    self.$elem\n                        .on('click' + namespace, self.toggle.bind(self));\n                    break;\n                case 'hover':\n                    self.$elem\n                        .add(self.config.hoverable ? self.$popup : null)\n                        .on('mouseenter' + namespace, self.show.bind(self))\n                        .on('mouseleave' + namespace, self.hide.bind(self));\n                    break;\n                case 'focus':\n                    self.$elem\n                        .on('focusin' + namespace, self.show.bind(self))\n                        .on('focusout' + namespace, self.hide.bind(self));\n                    break;\n            }\n\n            $window.on('resize' + namespace,\n                Fm.debounce(self.hide.bind(self), 200, true) // hide to force recalculation\n            );\n        },\n\n        /**\n         * Unbind event handlers.\n         */\n        unbind: function() {\n            var self = this,\n                namespace = self.namespace;\n\n            switch (self.config.trigger) {\n                case 'click':\n                    self.$elem\n                        .off('click' + namespace);\n                    break;\n                case 'hover':\n                    self.$elem\n                        .add(self.config.hoverable ? self.$popup : null)\n                        .off('mouseenter' + namespace)\n                        .off('mouseleave' + namespace);\n                    break;\n                case 'focus':\n                    self.$elem\n                        .off('focusin' + namespace)\n                        .off('focusout' + namespace);\n                    break;\n            }\n\n            $window.off('resize' + namespace);\n        },\n\n        /**\n         * Make cached calculations if needed.\n         *\n         * @return {boolean}\n         */\n        calculate: function() {\n            var offset = this.$elem.offset();\n\n            if (\n                this.calc\n                && this.calc.elem.top === offset.top\n                && this.calc.elem.left === offset.left\n            ) {\n                return false; // no need to position\n            }\n\n            this.calc = {\n                elem : {\n                    width  : this.$elem.outerWidth(),\n                    height : this.$elem.outerHeight(),\n                    top    : offset.top,\n                    left   : offset.left\n                },\n                popup : {\n                    width  : this.$popup.outerWidth(),\n                    height : this.$popup.outerHeight()\n                }\n            };\n\n            return true; // popup needs te be positioned\n        },\n\n        /**\n         * (Re)position the popup element.\n         */\n        position: function() {\n            if ( ! this.calculate())\n                return; // nothing changed\n\n            var self        = this,\n                calc        = self.calc,\n                direction   = self.$elem.data('direction') || self.config.direction,\n                distance    = self.config.distance,\n                positioning = {};\n\n            switch (direction) {\n                case 'north':\n                    positioning = {\n                        top  : calc.elem.top - calc.popup.height - distance,\n                        left : calc.elem.left + (calc.elem.width / 2) - (calc.popup.width / 2)\n                    };\n                    break;\n                case 'northeast':\n                    positioning = {\n                        top  : calc.elem.top - calc.popup.height - distance,\n                        left : calc.elem.left + calc.elem.width - calc.popup.width\n                    };\n                    break;\n                case 'east':\n                    positioning = {\n                        top  : calc.elem.top + (calc.elem.height / 2) - (calc.popup.height / 2),\n                        left : calc.elem.left + calc.elem.width + distance\n                    };\n                    break;\n                case 'southeast':\n                    positioning = {\n                        top  : calc.elem.top + calc.elem.height + distance,\n                        left : calc.elem.left + calc.elem.width - calc.popup.width\n                    };\n                    break;\n                case 'south':\n                    positioning = {\n                        top  : calc.elem.top + calc.elem.height + distance,\n                        left : calc.elem.left + (calc.elem.width / 2) - (calc.popup.width / 2)\n                    };\n                    break;\n                case 'southwest':\n                    positioning = {\n                        top  : calc.elem.top + calc.elem.height + distance,\n                        left : calc.elem.left\n                    };\n                    break;\n                case 'west':\n                    positioning = {\n                        top  : calc.elem.top + (calc.elem.height / 2) - (calc.popup.height / 2),\n                        left : calc.elem.left - calc.popup.width - distance\n                    };\n                    break;\n                case 'northwest':\n                    positioning = {\n                        top  : calc.elem.top - calc.popup.height - distance,\n                        left : calc.elem.left\n                    };\n                    break;\n            }\n\n            self.$popup\n                .css(positioning)\n                .addClass(ClassNames.popup + '--' + direction);\n        },\n\n        /**\n         * Toggle the popup.\n         */\n        toggle: function() {\n            this.active ?\n                this.hide():\n                this.show();\n        },\n\n        /**\n         * Show the popup.\n         */\n        show: function() {\n            var self = this,\n                conf = self.config;\n\n            clearTimeout(self.timer);\n\n            if ( ! self.active) {\n                self.position();\n                self.timer = setTimeout(function() {\n                    self.active = true;\n                    self.$popup.transition(conf.transition + 'In', {\n                        queue: false,\n                        onEnd: conf.onShow.bind(self.elem)\n                    });\n                }, conf.delay.show || conf.delay);\n            }\n        },\n\n        /**\n         * Hide the popup.\n         */\n        hide: function() {\n            var self = this,\n                conf = self.config;\n\n            clearTimeout(self.timer);\n\n            if (self.active) {\n                self.timer = setTimeout(function() {\n                    self.active = false;\n                    self.$popup.transition(conf.transition + 'Out', {\n                        queue: false,\n                        onEnd: conf.onHide.bind(self.elem)\n                    });\n                }, conf.delay.hide || conf.delay);\n            }\n        },\n\n        /**\n         * Override the instance's settings.\n         *\n         * @param {Object} settings\n         */\n        setting: function(settings) {\n            $.extend(this.config, settings);\n        },\n\n        /**\n         * Destroy the instance.\n         */\n        destroy: function() {\n            this.unbind();\n            this.$popup.remove();\n\n            $.data(this.elem, Name, null);\n        }\n\n    });\n\n    // Plugin\n\n    $.fn[Name] = function(settings, args) {\n        return this.each(function() {\n            var data = $.data(this, Name);\n\n            if ( ! data) {\n                $.data(this, Name, new Popup(this, settings));\n            } else if (typeof settings === 'string' && data[settings]) {\n                data[settings].apply(data, Array.isArray(args) ? args : [args]);\n            }\n        });\n    };\n\n    $.fn[Name].defaults = Defaults;\n\n})(jQuery, window, document);\n"]}