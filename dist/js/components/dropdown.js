/**
 * Dropdown plugin.
 *
 * @package Fundament
 */
!function(e,t){"use strict";function n(t,n){this.config=e.extend({},e.fn[s].defaults,n),this.elem=t,this.$elem=e(t),this.$menu=this.$elem.find(l.menu),this.$items=this.$elem.find(l.item),this.init()}function i(t){if("SELECT"!==t.nodeName)return t;var n=e(t),i=n.find("option"),s=i.filter(":selected"),o=e("<div/>",{class:a.dropdown+" "+a.select,tabindex:0}),l=e("<ul/>",{class:a.menu,role:"listbox","aria-hidden":!0}),r=e("<input/>",{type:"hidden",name:n.attr("name")}),c=e("<span/>",{text:s.text()});return i.each(function(){var t=e(this),n=a.item+(t.is(s)?" is-active":"");""!==t.val()&&e("<li/>",{text:t.text(),class:n,role:"option","data-value":t.val()}).appendTo(l)}),r.val(s.val()),o=n.wrap(o).after(l,c,r).parent(),n.remove(),o[0]}var s="dropdown",o={smart:!1,searchable:!1,transition:"display",onOpen:function(){},onOpening:function(){},onClose:function(){},onClosing:function(){},onSelect:function(e){}},a={dropdown:"dropdown",select:"dropdown--select",reversed:"dropdown--reversed",menu:"menu",item:"menu__item",open:"is-open",empty:"is-empty",active:"is-active"},l={menu:".menu",item:".menu__item",active:".is-active"};e.extend(n.prototype,{init:function(){this.setup(),this.bind(),this.is("select")&&this.is("empty")&&this.$elem.addClass(a.empty)},setup:function(){this.$elem.attr("tabindex",0),this.$items.attr("tabindex",-1)},bind:function(){this.$elem.on("mousedown",this.onMouseDown.bind(this)).on("keydown",this.onKeyDown.bind(this)).on("blur",this.close.bind(this))},is:function(e){var t=this;return{open:function(){return t.$elem.hasClass(a.open)},select:function(){return t.$elem.hasClass(a.select)},empty:function(){return 0===t.$elem.find("input").val().length}}[e].apply()},onMouseDown:function(n){if("A"===n.target.nodeName)return t.location.href=n.target.getAttribute("href");var i=e(n.target);i.hasClass(a.item)&&this.select(i),this.toggle()},onKeyDown:function(e){switch(e.which){case 13:case 32:this.toggle(),e.preventDefault();break;case 27:this.close();break;case 38:this.select("prev"),e.preventDefault();break;case 40:this.is("select")||this.open(),this.select("next"),e.preventDefault();break;default:this.selectByKey(e.which)}},select:function(e){var t,n=this,i=n.$items.filter(l.active);(t=e instanceof jQuery?e:i.length?"next"===e?i.next():i.prev():n.$items.first())&&0!==t.length&&!t.is(i)&&(i.removeClass(a.active),t.addClass(a.active),n.$elem.removeClass(a.empty),n.is("select")&&(n.$elem.find("> input").val(t.data("value")),n.$elem.find("> span").text(t.text())),n.config.onSelect.call(n.elem,t[0]))},selectByKey:function(t){var n=this,i=String.fromCharCode(t).toLowerCase();if(i){var s=n.$items.filter(function(){return e(this).text().substr(0,1).toLowerCase()===i});if(s.length){var o=s.index(s.filter(l.active)),a=e(s[o+1]);a&&a.length?n.select(a):n.select(s.first())}}},toggle:function(){this.is("open")?this.close():this.open()},open:function(){var e=this,n=e.config;if(!e.is("open")){if(n.onOpening.call(e.elem),n.smart){var i=e.$menu.outerHeight(),s=e.$elem.offset().top-t.pageYOffset,o=t.innerHeight-s-e.$elem.outerHeight();e.$elem.toggleClass(a.reversed,o<i&&s>i)}e.$menu.transition(n.transition+"In",{queue:!1,onEnd:n.onOpen.bind(e.elem)}),e.$elem.addClass(a.open)}},close:function(){var e=this,t=e.config;e.is("open")&&(t.onClosing.call(e.elem),e.$menu.transition(t.transition+"Out",{queue:!1,onEnd:t.onClose.bind(e.elem)}),e.$elem.removeClass(a.open))},setting:function(t){e.extend(this.config,t)}}),e.fn[s]=function(t,o){return this.each(function(){var a=i(this),l=e.data(this,s);l?"string"==typeof t&&l[t]&&l[t].apply(l,Array.isArray(o)?o:[o]):e.data(a,s,new n(a,t))})},e.fn[s].defaults=o}(jQuery,window);
//# sourceMappingURL=dropdown.js.map
